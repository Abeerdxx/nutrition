<h3>Meals</h3>

<table ng-controller="MealListCtrl">
    <thead>
        <tr>
            <th>Name</th>
            <th>Ingredients...</th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="meal in meals" ng-controller="MealIngredientList">
            <td><input type="text" placeholder="Name the new meal..." ng-model="meal.name"></td>
            <td>
                <div ng-switch on="mode">
                    <div ng-switch-when="list">
                        <button class="btn btn-link" ng-click="toggle()">
                            <span ng-repeat="i in meal.ingredients">{{i.food.name}} [{{i.amount}}{{getAmountUnit(i.food)}}]<span ng-show="!$last">, </span></span>
                            <span ng-show="meal.ingredients.length == 0">Add ingredients</span>
                        </button>
                    </div>
                    <div ng-switch-when="edit">
                        <table>
                            <tbody>
                                <tr ng-repeat="ing in ingredients">
                                    <td>{{ing.food.id}}</td>
                                    <td>
                                        <div class="input-append">
                                            <input type="number" ng-model="ing.amount">
                                            <span class="add-on">{{getAmountUnit(ing.food)}}</span>
                                        </div>
                                    </td>   
                                </tr>
                            </tbody>
                        </table>


                        <button class="btn btn-small" ng-click="toggle()"><i class="icon-ok"></i> done</button>
                    </div>
                </div>
            </td>
        </tr>
        <tr colspan=2>
            <td>
                <button class="btn btn-small btn-primary" ng-click="addMeal()"><i class="icon-plus icon-white"></i> meal</button>
            </td>
        </tr>
    </tbody>
</table>